<!doctype HTML public "-//W3O//DTD W3 HTML 3.0//EN">
<HTML>
<HEAD>
<TITLE>Перевод: Поляков А.В. http://www.avprog.narod.ru</TITLE>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<META name="description" content="Memory Access using 8086 Assembler">
<META name="keywords" content="memory access, 8086, tutorial, programming, assembler tutorial, tutorial for begginers">
<META name="robots" content="nofollow">
</HEAD>
<BODY bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#007099" alink="#FF0000">
<TABLE WIDTH=80%>
<TR><TD>
<FONT FACE="Verdana" SIZE=3>
<FONT SIZE=+1>
<B>Уроки Ассемблера 8086 для начинающих (Часть 2)</B>
</FONT><BR><BR>
<FONT SIZE=1>
Перевод: Поляков А.В. <A HREF="http://www.avprog.narod.ru">http://www.avprog.narod.ru</A>
</FONT><BR><BR><BR>
<FONT SIZE=+2><B>Доступ к памяти</B></FONT>
<BR><BR>
Для доступа к памяти можно использовать следующие четыре регистра: <B>BX, SI, DI, BP</B>.<BR><BR>
Комбинируя эти регистры внутри квадратных скобок <B>[ ]</B>, мы можем
получить доступ к различным местоположениям в памяти.
Возможны следующие комбинации (режимы адресации):

<BR><BR>

<FONT FACE="Fixedsys">

<TABLE BORDER=1 COLS=3 CELLPADDING=10>
<TR>

<TD>
[BX + SI]<BR>
[BX + DI]<BR>
[BP + SI]<BR>
[BP + DI]<BR>
</TD>

<TD>
[SI]<BR>
[DI]<BR>
d16 (только переменная-смещение)<BR>
[BX]<BR>
</TD>

<TD>
[BX + SI] + d8<BR>
[BX + DI] + d8<BR>
[BP + SI] + d8<BR>
[BP + DI] + d8<BR>
</TD>

</TR>

<TR>

<TD>
[SI] + d8<BR>
[DI] + d8<BR>
[BP] + d8<BR>
[BX] + d8<BR>
</TD>

<TD>
[BX + SI] + d16<BR>
[BX + DI] + d16<BR>
[BP + SI] + d16<BR>
[BP + DI] + d16<BR>
</TD>

<TD>
[SI] + d16<BR>
[DI] + d16<BR>
[BP] + d16<BR>
[BX] + d16<BR>
</TD>

</TR>
</TABLE>

</FONT>

<BR>

<B>d8</B> - обозначение для 8-ми битовой подстановки.<BR><BR>

<B>d16</B> - обозначение для 16-ми битовой подстановки.<BR><BR>

Подстановка может быть непосредственным значением или смещением переменной,
или даже и тем и другим. Она преобразуется компилятором в одиночное
непосредственное значение.<BR><BR>

Подстановка может быть как внутри так и вне квадратных скобок
(<B>[ ]</B>), компилятор генерирует одинаковый машинный код в обоих случаях.
<BR><BR>

Подстановка - это величина <B>со знаком</B>, поэтому она может быть как
положительной, так и отрицательной.
<BR><BR>

Обычно компилятор различает <B>d8</B> и <B>d16</B> и генерирует
требуемый машинный код.

<BR><BR><BR>

Например, представим что <B>DS = 100</B>, <B>BX = 30</B>, <B>SI = 70</B>.<BR>
Следующий способ адресации:
<B>[BX + SI] + 25</B>
<BR>
вычисляется процессором для этого физического адреса: <NOBR><B>100 * 16 + 30 + 70 + 25 = 1725</B>.</NOBR>
<BR><BR>
По умолчанию сегментный регистр <B>DS</B> используется для всех способов
адресации, кроме способа, который используется с регистром <B>BP</B>.
В последнем случае используют сегментный регистр <B>SS</B>.

<BR><BR>
Легко запомнить все возможные комбинации с помощью таблицы:
<BR><BR>
<IMG SRC="addressing_mode.gif">
<BR>
Вы можете формировать все имеющие силу комбинации, взяв по одному пункту из
каждого столбца, либо пропустить какой-либо столбец и ничего из него не взять.
Как вы можете видеть, <B>BX</B> и <B>BP</B> никогда не идут вместе.
<B>SI</B> и <B>DI</B> также не могут быть вместе. Здесь приведен пример
имеющего силу способа адресации: <B>[BX+5]</B>.

<BR><BR><BR>

<HR>

<BR><BR>
Значение в сегментном регистре (CS, DS, SS, ES) называется "<B>segment (сегмент)</B>",<BR>
а значение в регистре общего назначения (BX, SI, DI, BP) называется
"<B>offset (смещение)</B>".<BR>
Если DS содержит значение <B>1234h</B>, а SI содержит значение <B>7890h</B>,
то это можно записать как <B>1234:7890</B>. Физический адрес будет
таким: 1234h * 10h + 7890h = 19BD0h.

<BR><BR><BR>

<HR>

<BR><BR>
Чтобы указать компилятору тип данных,<BR>
должны использоваться эти префиксы:<BR><BR>
<B>BYTE PTR</B> - для байта.<BR>
<B>WORD PTR</B> - для слова (два байта).<BR><BR>
Например:<BR>
<PRE><FONT FACE="Fixedsys">BYTE PTR [BX]     ; доступ к байту.
    или
WORD PTR [BX]     ; доступ к слову.
</FONT></PRE>
<I>Emu8086</I> поддерживает короткие префиксы:<BR><BR>
<B>b.</B> - для <B>BYTE PTR</B><BR>
<B>w.</B> - для <B>WORD PTR</B><BR><BR>
иногда компилятор может вычислить тип данных автоматически, но вы не
можете и не должны полагаться на это, если один из операндов является
непосредственным значением.<BR><BR><BR>

<HR>



<BR>

<FONT SIZE=+2><B>Команда <U>MOV</U></B></FONT>
<BR><BR>

<UL>

	<LI>
	Копирует <B>второй операнд</B> (источник) в <B>первый
	операнд</B> (приемник).<BR><BR>
	</LI>

	<LI>
	Операнд-источник может быть непосредственным значением, регистром
	общего назначения или местоположением памяти.<BR><BR>
	</LI>

	<LI>
	Регистр-приемник может быть регистром общего назначения
	или местоположением памяти.<BR><BR>
	</LI>

	<LI>
	Оба операнда должны иметь одинаковый размер байта или слова.
	</LI>
</UL>

<TABLE BORDER=1 CELLPADDING=10 WIDTH=100%><TR><TD>

Эти типы операндов поддерживаются:<BR><BR>
<BLOCKQUOTE>
<FONT FACE="Fixedsys">
	MOV регистр, память<BR>
	MOV память, регистр<BR>
	MOV регистр, регистр<BR>
	MOV память, непосредственное значение (число)<BR>
	MOV регистр, непосредственное значение
</FONT>
</BLOCKQUOTE>

<B>регистр</B>:<FONT SIZE=-1> AX, BX, CX, DX, AH, AL, BL, BH, CH, CL, DH, DL, DI, SI, BP, SP.</FONT><BR><BR>
<B>память</B>: [BX], [BX+SI+7], переменная, и т.п...<BR><BR>
<B>непосредственное значение</B>: 5, -24, 3Fh, 10001101b, и т.п...<BR><BR>

</TD></TR></TABLE>

<BR>

<TABLE BORDER=1 CELLPADDING=10 WIDTH=100%><TR><TD>

Для сегментных регистров поддерживаются только эти типы <B>MOV</B>:<BR><BR>
<BLOCKQUOTE>
<FONT FACE="Fixedsys">
	MOV сегментный регистр, память<BR>
	MOV память, сегментный регистр<BR>
	MOV регистр, сегментный регистр<BR>
	MOV сегментный регистр, регистр<BR>
</FONT>
</BLOCKQUOTE>

<B>сегментный регистр</B>: DS, ES, SS, и только как второй операнд: CS.<BR><BR>
<B>регистр</B>:<FONT SIZE=-1> AX, BX, CX, DX, AH, AL, BL, BH, CH, CL, DH, DL, DI, SI, BP, SP.</FONT><BR><BR>
<B>память</B>: [BX], [BX+SI+7], переменная и т.п...<BR><BR>

</TD></TR></TABLE>

<BR>
Команда <B>MOV</B> <U>не может</U> использоваться для установки значений
регистров <B>CS</B> и <B>IP</B>.

<BR><BR>
<TABLE BORDER=1 CELLPADDING=10 WIDTH=100%><TR><TD>
Здесь короткая программа, которая демонстрирует использование команды <B>MOV</B>:<BR><BR>
<PRE>
<FONT FACE="Fixedsys">
#MAKE_COM#        ; команда компилятору для создания СОМ-файла.
ORG 100h          ; директива, необходимая для COM-программы.
MOV AX, 0B800h    ; установить AX в шестнадцатиричное значение B800h.
MOV DS, AX        ; копировать значение из AX в DS.
MOV CL, 'A'       ; установить в CL ASCII-код символа 'A', т.е. 41h.
MOV CH, 01011111b ; установить CH в двоичное значение.
MOV BX, 15Eh      ; установить BX в 15Eh.
MOV [BX], CX      ; копировать содержимое из CX в память с адресом B800:015E
RET               ; вернуться в операционную систему.
</FONT>
</PRE>
</TD></TR></TABLE>

<BR><BR>
Вы можете <B>скопировать и вставить</B> вышеописанную программу
в редактор кода <I>Emu8086</I>, и нажать кнопку [<B>Compile and Emulate</B>]
(или нажать клавишу <B>F5</B> на клавиатуре).<BR><BR>
Окно эмулятора должно открыться с загруженной программой. Щелкните
кнопку <NOBR>[<B>Single Step</B>] (пошаговый режим)</NOBR> и наблюдайте
за содержимым регистров.<BR>
<BR><BR>
Как <B>скопировать и вставить</B>: <BR>
<OL>
<LI>
Выделите техт программы с помощью мыши: щелкните перед текстом и, не
отпуская кнопки, продвигайте мышь, пока не будет выделен нужный текст.<BR><BR></LI>

<LI>Нажмите комбинацию клавиш <B>Ctrl + C</B> для копирования.<BR><BR></LI>

<LI>Перейдите в редактор кода <I>Emu8086</I> и нажмите комбинацию
клавиш <B>Ctrl + V</B>, чтобы вставить текст.</LI>

</OL>
<BR><BR>

Как вы могли догадаться, точка с запятой ("<B>;</B>") используется для
комментариев. Все символы, которые следуют за "<B>;</B>", игнорируются компилятором.<BR><BR>
<BR>
Вы должны увидеть нечто подобное, когда программа закончит свою работу:<BR><BR>
<IMG SRC="screen01.gif" WIDTH=426 HEIGHT=174>

<BR><BR>
Фактически, вышеописанная программа записывает данные непосредственно в
видеопамять, так что <B>MOV</B> - это очень мощная инструкция.

<BR><BR><BR>


<HR>
<CENTER>
<A HREF="asm_tutorial_01.html"><B> &lt;&lt;&lt; Предыдущая часть &lt;&lt;&lt; </B></A>
&nbsp;&nbsp;&nbsp;&nbsp;
<A HREF="asm_tutorial_03.html"><B> >>> Следующая часть >>> </B></A>
</CENTER>
<HR>


<BR>

</FONT>


</TD></TR>
</TABLE>



</BODY>

</HTML>
