<!doctype HTML public "-//W3O//DTD W3 HTML 3.0//EN">
<HTML>
<HEAD>
<TITLE>Перевод: Поляков А.В. http://www.avprog.narod.ru</TITLE>
<META name="description" content="Interrupts - 8086 Assembler">
<META name="keywords" content="interrupts, 8086, tutorial, programming, assembler tutorial, tutorial for begginers">
<META name="robots" content="nofollow">
</HEAD><BODY bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#007099" alink="#FF0000">
<TABLE WIDTH=80%>
<TR><TD>
<FONT FACE="Verdana" SIZE=3>
<FONT SIZE=+1>
<B>Глобальная таблица памяти</B>
</FONT><BR><BR>
<FONT SIZE=1>
Перевод: Поляков А.В. <A HREF="http://www.avprog.narod.ru">http://www.avprog.narod.ru</A>
</FONT><BR><BR><BR>


<B>Процессор 8086</B> может иметь доступ до <B>1 MB</B> оперативной паямти (ОЗУ - RAM).
Это ограничение связано с сегментной организацией памяти. Так как сегментные регистры
(<B>CS, SS, ES, DS</B>) могут хранить максимальные значения <B>0FFFFh</B>
и регистры смещения (<B>IP, BX, SI, DI, BP, SP</B>) также могут хранить
максимальное значение <B>0FFFFh</B>, то наибольший адрес памяти
может быть <B>FFFF:FFFF</B> или физический адрес:
<FONT FACE="Fixedsys"><NOBR>0FFFFh * 10h + 0FFFFh = 10FFEFh = 65535 * 16 + 65535 = 1114095 байтов</NOBR></FONT>
<BR>
Современные процессоры имеют регистры большего размера, поэтому они
могут иметь доступ к горазо большему объему памяти, но принцип доступа
остается тем же самым.
<BR><BR>

<HR>

<BR>

Таблица памяти эмулятора (и типичного IBM PC):<BR><BR>

<TABLE BORDER=1 CELLPADDING=10 COLS=2 WIDTH=100%>

<TR>
	<TD WIDTH=30%>
	<B>Физический адрес в области памяти (шестнадцатиричный)</B>
	</TD>
	<TD>
	<B>Краткое описание</B>
	</TD>
</TR>

<TR>
	<TD>
	00000 - 00400
	</TD>
	<TD>
	Векторы прерываний. Эмулятор загружает файл "<B>INT_VECT</B>" в физический адрес 00000h.
	</TD>
</TR>


<TR>
	<TD>
	00400 - 00500
	</TD>
	<TD>
	Область системной информации. Мы используем маленькую хитрость
	для установки некоторых параметров, загружая маленькую последнюю часть
	(21 байт) файла "<B>INT_VECT</B>" в эту область (размер этого
	файла 1045 или 415h байтов, поэтому загруженный файл занимает
	память от 00000 to 00415h).<BR>
	Этот блок памяти модернизируется эмулятором, если конфигурация
	изменяется (см. <A HREF="#sinfo"><B>Область системной информации)</B></A>.

	</TD>
</TR>

<TR>
	<TD>
	<B>00500 - A0000</B>
	</TD>
	<TD>
	Свободная область памяти. Блок размером <B>654080 байтов</B>. Сюда вы можете загрузить свою программу.
	</TD>
</TR>


<TR>
	<TD>
	A0000 - B1000
	</TD>
	<TD>
	Видеопамять для VGA, Monochrome и других адаптеров.
	Не используется эмулятором!
	</TD>
</TR>

<TR>
	<TD>
	B1000 - B8000
	</TD>
	<TD>
	Зарезервировано.
	Не используется эмулятором!
	</TD>
</TR>

<TR>
	<TD>
	B8000 - C0000
	</TD>
	<TD>
    32 KB видеопамяти для Color Graphics Adapter (CGA).
    Эмулятор использует эту область памяти для хранения 8-ми страниц
    видеопамяти. Размер экрана эмулятора может быть изменен, тогда
    для каждой страницы будет требоваться меньше памяти. Хотя эмулятор
    всегда использует 1000h (4096 байтов) для каждой страницы (см. INT 10h / AH=05h в
    <A HREF="supported_interrupts.html">списке поддерживаемых прерываний</A>).
	</TD>
</TR>

<TR>
	<TD>
	C0000 - F4000
	</TD>
	<TD>
    Зарезервировано.
	</TD>
</TR>

<TR>
	<TD>
	F4000 - 10FFEF
	</TD>
	<TD>
    ROM BIOS и расширения. Эмулятор загружает файл "<B>BIOS_ROM</B>"
    в физический адрес 0F4000h. Таблица прерываний указана в этой области
    памяти для получения эмуляции функций прерываний.
	</TD>
</TR>

</TABLE>


<BR><BR>

<TABLE BORDER=1 CELLPADDING=10 COLS=2 WIDTH=100%>
<TR><TD>
Векторы прерываний (память от 00000h до 00400h)

<PRE><FONT FACE="Fixedsys">
Номер            Адрес в таблице         Адрес подпрограммы
прерывания       векторов прерываний     BIOS
(hex)

00               00x4 = 00               F400:0170 - генерируется процессором,
                                                     ошибка деления.

04               04x4 = 10               F400:0180 - генерируется процессором,
                                                     обнаружение
                                                     переполнения INTO.

10               10x4 = 40               F400:0190 - Видеофункции.

11               11x4 = 44               F400:01D0 - Получение списка
                                                     оборудования BIOS.

12               12x4 = 48               F400:01A0 - Получение размера памяти.

13               13x4 = 4C               F400:01B0 - Дисковые функции.

15               15x4 = 54               F400:01E0 - Функции BIOS.

16               16x4 = 58               F400:01C0 - Функции клавиатуры.

19               19x4 = 64               FFFF:0000 - Перезагрузка.

1A               1Ax4 = 68               F400:0160 - Функции времени.

1E               1Ex4 = 78               F400:AFC7 - Вектор параметров дискеты.

20               20x4 = 80               F400:0150 - Функция DOS:
                                                     завершение программы.

21               21x4 = 84               F400:0200 - Функция DOS.

все другие       ??x4 = ??               F400:0100 - Перехватчик прерывания по умолчанию.
                                                     Печатает сообщение
                                                     "Interupt not supported yet"
                                                     ("Прерывание не поддерживается").
</FONT></PRE>
Вызов подсистемы BIOS дизассемблируется при
"BIOS DI" (он не использует регистр DI каким-либо способом,
это только способ декодирования: мы используем
"FF /7" для такого декодирования, "FFFFCD10" используется,
чтобы эмулятор мог эмулировать прерывание 10h).<BR><BR>
F400:0100 имеет этот код FFFFCDFF (декодированный как INT 255,
и генерируется сообщение об ошибке).

</TD></TR></TABLE>

<BR><BR>

<HR>
<A NAME="sinfo">&nbsp;</A>
<BR>

Область системной информации (память от 00400h до 00500h)

<BR><BR>

<TABLE BORDER=1 CELLPADDING=10 COLS=3 WIDTH=100%>
<TR>
<TD><B>Адрес (hex)</B></TD> <TD><B>Размер</B></TD> <TD><B>Описание</B></TD>
</TR>

<TR>
<TD>0040h:0010</TD> <TD>слово</TD>
<TD>
Список оборудования BIOS.
<PRE><FONT FACE="Fixedsys">
Состояние битов зависит от обнаруженного BIOS оборудования:
Бит(ы)	Описание
 15-14  количество параллельных портов.
 13     не поддерживается.
 12     игровой порт установлен.
 11-9   количество последовательных портов.
 8      зарезервировано.
 7-6    количество дисководов (минус 1):
          00 один дисковод;
          01 два дисковода;
          10 три дисковода;
          11 четыре дисковода.
 5-4    видеорежим:
          00 EGA,VGA,PGA, или другой встроенный видео BIOS;
          01 40x25 CGA цветной;
          10 80x25 CGA цветной (по умолчанию в эмуляторе);
          11 80x25 монохромный текстовый.
 3    не поддерживается.
 2    не поддерживается.
 1    математический сопроцессор установлен.
 0    установлен, если загрузка происходит с дискеты
      (всегда установлен в эмуляторе).
</FONT></PRE>
 Это слово также возвращается в <B>AX</B> прерыванием <B>INT 11h</B>.<BR>
 Значение по умолчанию: <B>0021h</B> или <B>0000 0000 0010 0001b</B>
</TD>
</TR>


<TR>
<TD>0040h:0013</TD> <TD>слово</TD>
<TD>
	Общая память (в килобайтах) начиная от абсолютного
	адреса 00000h.<BR>
 Это слово также возвращается в <B>AX</B> прерыванием <B>INT 12h</B>.<BR>
 Это значение установлено: <B>0280h</B> (640KB).
</TD>
</TR>


<TR>
<TD>0040h:004A</TD> <TD>слово</TD>
<TD>
Количество столбцов на экране.<BR>
  Значение по умолчанию: <B>0032h</B> (50 столбцов).
</TD>
</TR>


<TR>
<TD>0040h:004E</TD> <TD>слово</TD>
<TD>
Начальный адрес текущей видеостраницы в видеопамяти <NOBR>(после 0B800:0000).</NOBR><BR>
  Значени по умолчанию: <B>0000h</B>.
</TD>
</TR>

<TR>
<TD>0040h:0050</TD> <TD><NOBR>8 слов</NOBR></TD>
<TD>
Содержит позицию курсора (горизонтальную и вертикальную координаты)
на каждой из 8-ми страниц.<BR>
  Значение по умолчанию: <B>0000h</B> (для всех 8-ми слов).
</TD>
</TR>

<TR>
<TD>0040h:0062</TD> <TD>байт</TD>
<TD>
Номер текущей видеостраницы.<BR>
  Значение по умолчанию: <B>00h</B> (1-я страница).
</TD>
</TR>

<TR>
<TD>0040h:0084</TD> <TD>байт</TD>
<TD>
Количество строк на экране минус 1.<BR>
  Значение по умолчанию: <B>13h</B> (19+1=20 строк).
</TD>
</TR>

</TABLE>

<BR><BR>
<BR>См. также:
<A HREF="custom_memory_map.html"><B>Пользовательская таблица памяти</B></A>
<BR><BR><BR>

</FONT>

</TD></TR>
</TABLE>

<BR>



</BODY>

</HTML>
