<!doctype HTML public "-//W3O//DTD W3 HTML 3.0//EN">
<HTML>
<HEAD><TITLE>Перевод: Поляков А.В. http://www.avprog.narod.ru</TITLE>
<META name="description" content="Interrupts currently supported by emulator">
<META name="keywords" content="supported, interrupts">
<META name="robots" content="nofollow"></HEAD>
<BODY bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#007099" alink="#FF0000">
<FONT FACE="Verdana" SIZE=3>
<TABLE WIDTH=80%>
<TR><TD>
<FONT SIZE=+1>
<B>Прерывания, поддерживаемые в настоящее время эмулятором</B>
</FONT><BR><BR>
<FONT SIZE=1>
Перевод: Поляков А.В. <A HREF="http://www.avprog.narod.ru">http://www.avprog.narod.ru</A>
</FONT><BR><BR><BR>
<HR><BR>Быстрые ссылки:<BR><BR>
<FONT FACE="Fixedsys">
<TABLE WIDTH=100%>
<TR>

<TD>
<A HREF="#int10h_00h">INT 10h/00h</A><BR>
<A HREF="#int10h_01h">INT 10h/01h</A><BR>
<A HREF="#int10h_02h">INT 10h/02h</A><BR>
<A HREF="#int10h_03h">INT 10h/03h</A><BR>
<A HREF="#int10h_05h">INT 10h/05h</A><BR>
<A HREF="#int10h_06h">INT 10h/06h</A><BR>
<A HREF="#int10h_07h">INT 10h/07h</A><BR>
</TD>

<TD>
<A HREF="#int10h_08h">INT 10h/08h</A><BR>
<A HREF="#int10h_09h">INT 10h/09h</A><BR>
<A HREF="#int10h_0Ah">INT 10h/0Ah</A><BR>
<A HREF="#int10h_0Eh">INT 10h/0Eh</A><BR>
<A HREF="#int10h_13h">INT 10h/13h</A><BR>
<A HREF="#int10h_1003h">INT 10h/1003h</A><BR>
<A HREF="#int11h">INT 11h</A><BR>
</TD>

<TD>
<A HREF="#int12h">INT 12h</A><BR>
<A HREF="#int13h_00h">INT 13h/00h</A><BR>
<A HREF="#int13h_02h">INT 13h/02h</A><BR>
<A HREF="#int13h_03h">INT 13h/03h</A><BR>
<A HREF="#int15h_86h">INT 15h/86h</A><BR>
<A HREF="#int16h_00h">INT 16h/00h</A><BR>
<A HREF="#int16h_01h">INT 16h/01h</A><BR>
</TD>

<TD>
<A HREF="#int19h">INT 19h</A><BR>
<A HREF="#int1Ah_00h">INT 1Ah/00h</A><BR>
<A HREF="#int21h">INT 21h</A><BR>
</TD>

</TR></TABLE></FONT><BR><BR>
<HR>
<BR>
Список поддерживаемых прерываний с описаниями:<BR><BR>

<A NAME="int10h_00h">&nbsp;</A>

<HR>

     <B>INT 10h</B> / <B>AH = 00h</B> - установить видеорежим.<BR>

     <BLOCKQUOTE>
     	<I>вход:</I><BR>
     	<B>AL</B> = нужный видеорежим.<BR>
     	<BR>
		Следующие видеорежимы поддерживаются:<BR><BR>
		<B>00h</B> - Текстовый режим 40x25, 16 цветов, 8 страниц.<BR><BR>

		<B>03h</B> - Текстовый режим 80x25, 16 цветов, 8 страниц.

     </BLOCKQUOTE>

<A NAME="int10h_01h">&nbsp;</A>
<HR>

     <B>INT 10h</B> / <B>AH = 01h</B> - установить форму курсора в текстовом режиме.<BR>

     <BLOCKQUOTE>
     	<I>вход:</I><BR>
     	<B>CH</B> = вершина курсора (биты 0-4) и опции (биты 5-7).<BR>
     	<B>CL</B> = основание курсора (биты 0-4).<BR>
     	<BR>
     	Если биты 6-5 регистра CH установлены в <B>00</B>, то курсор
     	виден. Чтобы скрыть курсор, установите биты в <B>01</B>
     	(следующее значение в CH будет скрывать курсор: 28h - 0<U>01</U>01000b).
     	Бит 7 должен быть всегда нулем.<BR><BR>

     	<U>Примечание переводчика</U>. Высота курсора - это разность между вершиной
     	и основанием курсора. Т.е. если установить биты 0-4 регистра
     	СН в 00000, а регистра CL - в 11111, то курсор будет высотой
     	в 32 строки (не текстовых строки - а строки экранных). Если установить
     	биты 0-3 регистра СН в 1111, а регистра CL - в 1111, то курсор будет
     	высотой в одну строку и располагаться под буквами. Ну и так далее...
     </BLOCKQUOTE>

<A NAME="int10h_02h">&nbsp;</A>
<HR>

     <B>INT 10h</B> / <B>AH = 02h</B> - установить позицию курсора.<BR>

     <BLOCKQUOTE>
     	<I>вход:</I><BR>
     	<B>DH</B> = строка.<BR>
     	<B>DL</B> = столбец.<BR>
     	<B>BH</B> = номер страницы (0..7).<BR>
     </BLOCKQUOTE>

<A NAME="int10h_03h">&nbsp;</A>
<HR>

     <B>INT 10h</B> / <B>AH = 03h</B> - получить позицию и размер курсора.<BR>
     <BLOCKQUOTE>
     	<I>вход:</I><BR>
     	<B>BH</B> = номер страницы.<BR>
     	<I>выход:</I><BR>
     	<B>DH</B> = строка.<BR>
     	<B>DL</B> = столбец.<BR>
     	<B>CH</B> = вершина курсора.<BR>
     	<B>CL</B> = основание курсора.<BR>
     </BLOCKQUOTE>

<A NAME="int10h_05h">&nbsp;</A>
<HR>

     <B>INT 10h</B> / <B>AH = 05h</B> - выбрать активную видео страницу.<BR>
     <BLOCKQUOTE>
     	<I>вход:</I><BR>
     	<B>AL</B> = номер новой страницы (0..7).<BR>
     	активированная страница отображается.
     </BLOCKQUOTE>

<A NAME="int10h_06h">&nbsp;</A>
<A NAME="int10h_07h">&nbsp;</A>
<HR>

	 <B>INT 10h</B> / <B>AH = 06h</B>	- прокрутка окна вверх.<BR>
	 <B>INT 10h</B> / <B>AH = 07h</B> - прокрутка окна вниз.<BR>
	 <BLOCKQUOTE>
	 	 <I>вход:</I><BR>
		 <B>AL</B> = количество строк, которые должны быть прокручены (00h = полная очистка окна).<BR>
		 <B>BH</B> = <A HREF="#attrib">атрибут</A>, используемый для записи строки пробелов в нижней части окна.<BR>
		 <B>CH, CL</B> = строка, столбец - координаты верхнего левого угла окна.<BR>
		 <B>DH, DL</B> = строка, столбец - координаты нижнего правого угла окна.<BR>
	 </BLOCKQUOTE>

<A NAME="int10h_08h">&nbsp;</A>
<HR>

     <B>INT 10h</B> / <B>AH = 08h</B> - прочитать символ и <A HREF="#attrib">атрибут</A> с позиции курсора.<BR><BR>
	 <BLOCKQUOTE>
	 	 <I>вход:</I><BR>
	 	 <B>BH</B> = номер страницы.<BR>
	 	 <I>выход:</I><BR>
	 	 <B>AH</B> = <A HREF="#attrib">атрибут</A>.<BR>
	 	 <B>AL</B> = символ.<BR>
	 </BLOCKQUOTE>

<A NAME="int10h_09h">&nbsp;</A>
<HR>

     <B>INT 10h</B> / <B>AH = 09h</B> - записать символ и <A HREF="#attrib">атрибут</A> в позиции курсора.<BR><BR>
	 <BLOCKQUOTE>
	 	 <I>вход:</I><BR>
	 	 <B>AL</B> = символ для вывода на экран.<BR>
	 	 <B>BH</B> = номер страницы.<BR>
	 	 <B>BL</B> = <A HREF="#attrib">атрибут</A>.<BR>
	 	 <B>CX</B> = сколько раз символ будет выведен на экран.<BR>
	 </BLOCKQUOTE>

<A NAME="int10h_0Ah">&nbsp;</A>
<HR>

     <B>INT 10h</B> / <B>AH = 0Ah</B> - записать символ только в позицию курсора.<BR><BR>
	 <BLOCKQUOTE>
	 	 <I>вход:</I><BR>
	 	 <B>AL</B> = символ для вывода на экран.<BR>
	 	 <B>BH</B> = номер страницы.<BR>
	 	 <B>CX</B> = сколько раз символ будет выведен на экран.<BR>
	 </BLOCKQUOTE>


<A NAME="int10h_0Eh">&nbsp;</A>
<HR>

     <B>INT 10h</B> / <B>AH = 0Eh</B> - вывод в режиме телетайпа.<BR><BR>
	 <BLOCKQUOTE>
	 	 <I>вход:</I><BR>
	 	 <B>AL</B> = символ для записи.
	 </BLOCKQUOTE>
	 Эта функция отображает символ на экране, передвигает курсор и
	 прокручивает экран, если это необходимо. Печать всегда
	 выполняется на текущей видеостранице.
	<BR><BR>

<A NAME="int10h_13h">&nbsp;</A>
<HR>

     <B>INT 10h</B> / <B>AH = 13h</B> - записать строку.<BR><BR>
	 <BLOCKQUOTE>
	 	 <I>вход:</I><BR>
	 	 <B>AL</B> = режим записи:<BR>
	 	 &nbsp; &nbsp; <B>bit 0</B>: не изменять курсор после записи;<BR>
	 	 &nbsp; &nbsp; <B>bit 1</B>: строка содержит <A HREF="#attrib">атрибуты</A>.<BR>
	 	 <B>BH</B> = номер страницы.<BR>
	 	 <B>BL</B> = <A HREF="#attrib">атрибут</A>, если строка содержит только символы (бит 1 регистра AL - ноль).<BR>
	 	 <B>CX</B> = количество символов в строке (атрибуты не считаются).<BR>
	 	 <B>DL,DH</B> = столбец, строка - координаты, с которых начинается запись строки.<BR>
	 	 <B>ES:BP</B> указатель на строку, которая будет напечатана.
	 </BLOCKQUOTE>
	<BR>

<A NAME="int10h_1003h">&nbsp;</A>
<HR>

     <B>INT 10h</B> / <B>AX = 1003h</B> - выбрать интенсивность/мерцание.<BR><BR>
	 <BLOCKQUOTE>
	 	 <I>вход:</I><BR>
	 	 <B>BL</B> = режим записи:<BR>
	 	 &nbsp; &nbsp; <B>0</B>: включить интенсивность (16 возможных цветов фона).<BR>
	 	 &nbsp; &nbsp; <B>1</B>: включить мерцание (не поддерживается эмулятором!).<BR>
	 	 <B>BH</B> = 0 (чтобы избежать проблем на некоторых адаптерах).<BR>
	 </BLOCKQUOTE>
	<BR>

<HR>

<A NAME="attrib">&nbsp;</A><BR>
<B>Таблица цветов:</B><BR>
Атрибут символа - это 8-ми битовое значение. Младшие четыре бита
представляют набор цветов переднего плана, а старшие 4 бита - цвета фона.
Мерцание цветов фона не поддерживается.<BR>

<PRE><FONT FACE="Fixedsys">
HEX    BIN       ЦВЕТ

0      0000      черный
1      0001      синий
2      0010      зеленый
3      0011      бирюзовый
4      0100      красный
5      0101      фиолетовый
6      0110      коричневый
7      0111      светло-серый
8      1000      темно-серый
9      1001      светло-синий
A      1010      светло-зеленый
B      1011      голубой (светло-бирюзовый)
C      1100      ярко-красный
D      1101      малиновый
E      1110      желтый
F      1111      белый
</FONT></PRE>


<A NAME="int11h">&nbsp;</A>
		<HR>

      <BR>

		<B>INT 11h</B> - получить список оборудования BIOS.<BR>
		 <BLOCKQUOTE>
			 <I>выход:</I><BR>
			 <B>AX</B> = слово списка оборудования BIOS. Фактически
			 эта функция возвращает содержимое слова в 0040h:0010h.<BR><BR>
			 В настоящее время эта функция может использоваться для
			 определения количества дисководов.

			 <PRE><FONT FACE="Fixedsys">
Описание битов для обнаруженного BIOS установленного оборудования:
Бит(ы)	Описание
 15-14  количество параллельных портов.
 13     не поддерживается.
 12     игровой прот установлен.
 11-9   количество последовательных портов.
 8      зарезервировано.
 7-6    количество дисководов (минус 1):
          00 один дисковод;
          01 два дисковода;
          10 три дисковода;
          11 четыре дисковода.
 5-4    видеорежимы:
          00 EGA,VGA,PGA, или другой со встроенной видео BIOS;
          01 40x25 CGA цвета;
          10 80x25 CGA цвета (по умолчанию в эмуляторе);
          11 80x25 монохромный текст.
 3    не поддерживается.
 2    не поддерживается.
 1    математический сопроцессор установлен.
 0    установлен, если дисковод может быть загрузочным (всегда установлен в эмуляторе).
</FONT></PRE>
		 </BLOCKQUOTE>

<A NAME="int12h">&nbsp;</A>
		<HR>

      <BR>

		<B>INT 12h</B> - получить размер памяти.<BR>
		 <BLOCKQUOTE>
			 <I>выход:</I><BR>
			 <B>AX</B> = килобайты смежной памяти,
			 начинающейся с абсолютного адреса 00000h.
			 Возвращает содержимое слова по адресу 0040h:0013h.
		 </BLOCKQUOTE>

		<HR>

		<BR>

		<B>Дисководы эмулируются с помощью  <B>файлов</B> </B> <I>FLOPPY_0(..3)</I>.

		<BR><BR>


<A NAME="int13h_00h">&nbsp;</A>
		<HR>

		<BR>

		<B>INT 13h</B> / <B>AH = 00h</B> - сброс дисковода (в настоящее время эта функция не работает).

		<BR><BR>

<A NAME="int13h_02h">&nbsp;</A>
<A NAME="int13h_03h">&nbsp;</A>
		<HR>

		<BR>

     	<B>INT 13h</B> / <B>AH = 02h</B> - прочитать сектор диска в память.<BR>
     	<B>INT 13h</B> / <B>AH = 03h</B> - записать сектор на диск.<BR>
     	<BLOCKQUOTE>
     	<I>вход:</I><BR>
     		<BLOCKQUOTE>
			<B>AL</B> = количество секторов для чтения/записи (не должно быть нулем)<BR>
			<B>CH</B> = номер цилиндра (0..79).<BR>
			<B>CL</B> = номер сектора (1..18).<BR>
			<B>DH</B> = номер головки (0..1).<BR>
			<B>DL</B> = номер дисковода (0..3 , зависит от количества файлов FLOPPY_?).<BR>
			<B>ES:BX</B> указатель на буфер данных.<BR>
			</BLOCKQUOTE>
		<I>выход:</I><BR>
			<BLOCKQUOTE>
		    <B>CF</B> устанавливается в случае ошибки.<BR>
			<B>CF</B> очищен, если ошибок нет.<BR>
			<B>AH</B> = состояние (0 - если все выполнено успешно).<BR>
			<B>AL</B> = количество переданных секторов. <BR>
			</BLOCKQUOTE>

			Примечание: каждый сектор имеет <B>512</B> байтов.
		</BLOCKQUOTE>


<A NAME="int15h_86h">&nbsp;</A>
		<HR>

		<BR>

		<B>INT 15h</B> / <B>AH = 86h</B> - функция ожидания BIOS.
     	<BLOCKQUOTE>
     	<I>вход:</I><BR>
     		<BLOCKQUOTE>
            <B>CX:DX</B> = интервал в микросекундах
            </BLOCKQUOTE>
		<I>выход:</I><BR>
			<BLOCKQUOTE>
            <B>CF</B> сброшен, если операция выполнена успешно (ждет окончания интервала),<BR>
            <B>CF</B> установлен, если произошла ошибка или функция ожидания уже в работе.
            </BLOCKQUOTE>
            <BR>
            <I>Примечание:</I>
            <BLOCKQUOTE>
            на многих системах разрешение периода ожидания равно 977 микросекундам.
            Emu8086 использует 1000-микросекундный период.
           	</BLOCKQUOTE>
		</BLOCKQUOTE>
		<BR>

<A NAME="int16h_00h">&nbsp;</A>
		<HR>

		<BR>

		<B>INT 16h</B> / <B>AH = 00h</B> - прочитать следующую нажатую клавишу (без эха).<BR>
		<BLOCKQUOTE>
            <I>выход:</I><BR>
            	<BLOCKQUOTE>
            	<B>AH</B> = скан-код BIOS.<BR>
                <B>AL</B> = ASCII-символ.<BR>
                (если клавиша прочитана, она удаляется из буфера клавиатуры).
            	</BLOCKQUOTE>
        </BLOCKQUOTE>

<A NAME="int16h_01h">&nbsp;</A>
 		<HR>
		<BR>

		<B>INT 16h</B> / <B>AH = 01h</B> - проверить готовность символа в буфере клавиатуры.<BR>
		<BLOCKQUOTE>
            <I>выход:</I><BR>
            	<BLOCKQUOTE>
            	<B>ZF = 1</B> если символ не готов.<BR>
            	<B>ZF = 0</B> если символ готов.<BR>
            	<B>AH</B> = скан-код BIOS.<BR>
                <B>AL</B> = ASCII-символ.<BR>
                (если клавиша прочитана, она удаляется из буфера клавиатуры).
            	</BLOCKQUOTE>
        </BLOCKQUOTE>


<A NAME="int19h">&nbsp;</A>
 		<HR>

		<BR>

		<B>INT 19h</B> - перезагрузка системы.<BR>
		<BLOCKQUOTE>
		Обычно BIOS пытается прочитать сектор 1, головку 0, дорожку 0 с дисковода А: в 0000h:7C00h.
		Эмулятор просто останавливает выполнение. Для загрузки
		с дисковода выберите из меню:
        <B>'Virtual Drive' -> 'Boot from Floppy'</B>
        </BLOCKQUOTE>


<A NAME="int1Ah_00h">&nbsp;</A>
 		<HR>

		<BR>

		<B>INT 1Ah</B> / <B>AH = 00h</B> - получить системное время.<BR>
		<BLOCKQUOTE>
            <I>выход:</I><BR>
            	<BLOCKQUOTE>
            	<B>CX:DX</B> = количество тиков, начиная с полночи.<BR>
                <B>AL</B> = 0, если таймер не переполнялся за 24 часа с момента сброса.<BR>
            	</BLOCKQUOTE>
        </BLOCKQUOTE>

		Примечания:<BR>
		Часы обновляются приблизительно <B>18.20648</B> раз в секунду,<BR>
		    и <B>1800B0h</B> за 24 часа.
		<BR><B>AL</B>  еще не устанавливается эмулятором!


<A NAME="int21h">&nbsp;</A>
 		<HR>

	<BR><BR>

	<B>MS-DOS все-же не может полностью быть загружен в эмулятор,
	поэтому я сделал эмуляцию для некоторых основных прерываний DOS:<BR><BR></B>
	<B>INT 20h</B> - выход в операционную систему.<BR><BR>
	<B>INT 21h</B> / <B>AH=09h</B> - вывод строки из DS:DX.<BR><BR>
	<B>INT 21h</B> / <B>AH=0Ah</B> - ввод строки в DS:DX, первый байт - размер буфера, второй байт - количество фактически прочитанных символов.<BR><BR>
	<B>INT 21h</B> / <B>AH=4Ch</B> - выход в операционную систему.<BR><BR>
	<B>INT 21h</B> / <B>AH=01h</B> - чтение символа из стандартного устройства ввода с эхом, результат записывается в AL.<BR><BR>
	<B>INT 21h</B> / <B>AH=02h</B> - запись символа в стандартное устройство вывода, DL = символ для записи. После выполнения AL = DL.<BR><BR>

	<BR>


<HR>

<BR>

<!--
	<FONT SIZE=2>
	Development process never stops,<BR>
	so check my
	<A HREF="http://www.emu8086.com/update.html"><B>homepage</B></A>
	from time to time for an update.
	</FONT>
-->


<BR><BR>

</TD></TR>
</TABLE>

<BR>

</FONT>

</BODY>

</HTML>
